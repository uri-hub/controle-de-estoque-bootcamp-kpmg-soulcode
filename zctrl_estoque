REPORT ZCTRL_ESTOQUE.

INCLUDE: ZCTRL_ESTOQUE_SOS,
         ZCTRL_ESTOQUE_F_PRDT01.

DATA: LV_COMMAND TYPE C LENGTH 10.

CLASS LCL_CONTROLE DEFINITION.
  PUBLIC SECTION.
    TYPES: BEGIN OF TY_FILTROS,
             P_PDT_ID TYPE ZTB_PRODUTOS-PROD_ID,
             P_DESCR  TYPE ZTB_PRODUTOS-DESCR,
             P_PRECO  TYPE ZTB_PRODUTOS-PRECO,
             P_QTD    TYPE ZTB_PRODUTOS-QTD,
             P_CATEG  TYPE ZTB_PRODUTOS-CATEGORIA,
             B_ADD    TYPE TEXT20,
             B_UPDT   TYPE TEXT20,
             B_DEL    TYPE TEXT20,
             B_SHOW   TYPE TEXT20,
           END OF TY_FILTROS.

    CLASS-DATA: V_FILTROS TYPE  TY_FILTROS,
                GV_TELA   TYPE DYNNR.

    CLASS-METHODS CREAT RETURNING VALUE(R_RESULT) TYPE REF TO LCL_CONTROLE.

    METHODS: RUN IMPORTING VALUE(_TELA) TYPE DYNNR VALUE(_FILTROS) TYPE TY_FILTROS.
ENDCLASS.

CLASS LCL_CONTROLE IMPLEMENTATION.
  METHOD CREAT.
    CREATE OBJECT R_RESULT.
  ENDMETHOD.


  METHOD RUN.

    ME->GV_TELA = _TELA.
    ME->V_FILTROS = _FILTROS.


    CASE GV_TELA.
      WHEN '0101'.
        PERFORM F_PRODUTO USING LV_COMMAND.

      WHEN '0102'.
      WHEN OTHERS.
    ENDCASE.


  ENDMETHOD.

ENDCLASS.



INITIALIZATION.
  TAB1 = 'Controle de Estoque'.

  B_ADD = '@0Y@  CADASTRAR'.
  B_UPDT = '@7A@  ATUALIZAR'.
  B_DEL = '@11@  REMOVER'.
  B_SHOW = '@UI@  EXIBIR'.

START-OF-SELECTION.

  DATA(LO_CONTROLE) = NEW LCL_CONTROLE( ).

  LO_CONTROLE->RUN( _TELA = T1-DYNNR
    _FILTROS = VALUE LCL_CONTROLE=>TY_FILTROS(
    P_PDT_ID = P_PDT_ID
    P_DESCR = P_DESCR
    P_PRECO = P_PRECO
    P_QTD = P_QTD
    P_CATEG = P_CATEG
    B_ADD = B_ADD
    B_UPDT = B_UPDT
    B_DEL = B_DEL
    B_SHOW = B_SHOW ) ).

AT SELECTION-SCREEN.

  CASE SY-UCOMM.
    WHEN 'ADD'.
      PERFORM F_PRODUTO USING 'ADD'.
    WHEN 'UPDT'.
      PERFORM F_PRODUTO USING 'UPDT'.
    WHEN 'DEL'.
      PERFORM F_PRODUTO USING 'DEL'.
    WHEN 'SHOW'.
      PERFORM F_PRODUTO USING 'SHOW'.
    WHEN OTHERS.
      MESSAGE 'Comando n√£o reconhecido!' TYPE 'E'.
  ENDCASE.
